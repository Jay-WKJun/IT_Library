# 네트워크 기기

- 라우터
- 레이어2 스위치
- 레이어3 스위치

# 프로토콜

 통신하기 위한 규칙을 “프로토콜"이라고 하며 여러 프로토콜을 조합해 네트워크 아키텍쳐가 된다. 대표적으로 TCP/IP가 있다.

 * **호스트** = 각각의 네트워크 단말들을 “호스트"라고 합니다.

## TCP/IP

요즘은 거의 TCP/IP 프로토콜로 통신합니다.

4계층으로 이루어져있습니다.

(7계층으로 이루어진 OSI 참조 모델이 있지만, 실전에서는 거의 사용되지 않습니다.)

| TCP/IP의 계층 | 설명 | 데이터 명칭 | 주요 프로토콜 |
| --- | --- | --- | --- |
| 애플리케이션 층 | 해당 애플리케이션에서 다룰 데이터 형식과 절차를 결정한다. | 메시지 | HTTP, SMTP, POP3,IMAP4, DHCP, DNS 등 |
| 트랜스포트 층 | 단말 내 적절한 애플리케이션에 데이터를 할당한다.
TCP는 큰 파일을 적절히 분해하기도 한다. | 세그먼트 for TCP
데이터그램 for UDP | TCP, UDP |
| 인터넷 층 | 엔드 투 엔드 통신을 한다.
서로의 위치를 특정하는 역할을 한다. | 패킷 또는 데이터그램 | IP, ICMP, ARP 등 |
| 네트워크 인터페이스 층 | 자유롭게 선택할 수 있는 계층, 반드시 상대방과 맞지 않아도 된다.
물리적인 통신 인터페이스가 이 계층에 속한다. | 프레임 | 이더넷, 무선 LAN(Wi-Fi), PPP 등 |

아래부터 각 계층에 대해서 자세히 알아본다.

## 네트워크 인터페이스 층

역할 : **같은 네트워크 안**에서 데이터를 전송하는 것.

같은 네트워크 안이란...? 하나의 레이어2 스위치에 연결된 나머지 단말들까지의 범위

각 레이어2 스위치는 레이어3 스위치나 라우터에 의해 연결된다.

## 인터넷 층

출발지와 최종 목적지를 연결하는 역할을 합니다. 즉, “엔드투엔드" 통신의 역할을 맡고 있는 것입니다.

여러 네트워크를 연결하는 라우터를 거쳐, 최종 목적지까지의 가는 라우트 과정을 “라우팅"이라고 합니다.

## 트랜스포트 층

데이터를 적절한 애플리케이션에 배분하는 역할을 합니다.

### TCP

트랜스포트 층의 TCP는 엔드투엔드의 신뢰성을 확보해 주는 기능을 합니다.

데이터의 분할과 조립도 담당합니다.

## 애플리케이션 층

어떤 애플리케이션의 기능을 실행하기 위한 데이터의 형식과 처리 절차 등을 결정합니다.

이 계층을 최종으로 0101이 아닌 인간이 볼 수 있는 데이터 형태로 데이터를 표현합니다. (문자, 이미지 등)

여기에 해당하는 여러 프로토콜 중에선 DHCP와 DNS는 특이하게 애플리케이션이 사용하기 위한 프로토콜이 아닌 애플리케이션의 통신을 준비하기 위한 프로토콜입니다.

## 그렇다면 프로토콜은 어떻게 지켜지는 것일까?

**통신을 위한 복수의 프로토콜들을 데이터의 헤더에 붙입니다.** 각각의 정보는 해당하는 프로토콜들을 제어할 수 있는 정보를 담고 있습니다.

상위 프로토콜부터 차례대로 헤더를 추가해 나갑니다.

최종적으론 물리적인 신호로 변환되어 전송됩니다.

### 목적지에 도착한 후에는?

1. 전송된 물리적인 신호는 0101인 디지털 데이터로 바꾸어 데이터를 복원합니다.
2. 이더넷 헤더를 참조해 자기 앞으로 온 데이터인지 확인하고, FCS로 데이터에 오류가 없는지 확인합니다.
3. IP에서 IP 헤더를 참조해 자기 앞으로 온 데이터인지 확인합니다.
4. TCP에서 어느 애플리케이션의 데이터인지 확인합니다.
5. 만약, 웹 서버 애플리케이션이라고 하면, 웹 서버에 애플리케이션에 데이터가 도달해, HTTP 헤더와 그 뒤 데이터 부분을 처리합니다.

## IP (Internet Protocol)

네트워크상의 한 PC에서 다른 PC로 데이터를 전송하는 역할을 맡습니다.

IP 프로토콜의 IP 주소를 통해 출발지와 도착지를 정확히 특정해냅니다.

라우터가 IP 프로토콜을 보고 목적지까지 “라우팅"합니다.

### IP 주소 할당 규칙

호스트을 정확히 특정하는 IP 주소는 그럼 어떻게 할당되는 것일까??

보통 그 호스트 자체를 특정하여 IP 주소가 주어진다고 생각하지만,

실은 호스트의 **네트워크 인터페이스를 대상으로 IP 주소가 주어지는 것.**

즉, 유선 이더넷 인터페이스와 무선 LAN 인터페이스가 같이 있는 노트북의 경우엔 각 인터페이스 당 하나씩 IP 주소가 주어지게 된다.

### IP 주소의 구성

IPv4 기준 32비트로 구성되어있고, 보통은 사람들이 구별할 수 있도록 8개씩 4개로 쪼갠 후, 자연수로 전환하여 보여집니다.

8비트 자연수 범위는 0~255입니다.

### 데이터의 목적지가 다수라면?

데이터를 전송하는 목적지에 따라서 3가지로 나눌 수 있다.

- 유니캐스트
    
    단 한 곳으로 데이터를 전송하는 것.
    
    (유니캐스트를 여러번해서 브로드캐스트를 해야겠다라고 생각할 수 있지만, 매우 비효율적이라고 한다.)
    
- 브로드캐스트
    
    같은 네트워크 상의 모든 호스트에 완전히 똑같은 데이터를 전송하는 것.
    
    255.255.255.255 주소가 브로드캐스트를 위한 IP 주소입니다.
    
- 멀티캐스트
    
    특정 그룹에 포함되는 호스트에 완전히 똑같은 데이터를 전송하는 것.
    
    224.0.0.0 ~ 239.255.255.255 주소 범위가 멀티캐스트의 IP주소 범위입니다.
    

## IP 주소의 범위구분

IP 주소는 크게 네트워크를 구별하는 “네트워크부"와 네트워크 내의 호스트를 식별하는 “호스트부"로 나뉘어 있습니다.

이 “네트워크부"와 “호스트부"는 정해져 있는 것이 아닌 가변적입니다.

따라서 어디까지가 네트워크부인지 명시하는 “서브넷 마스크"가 있습니다.

### 서브넷 마스크

IP 주소처럼 32비트이고, 1은 네트워크부, 0은 호스트부를 나타냅니다.

따라서 서브넷 마스크는 반드시 연속한 1과 연속한 0으로 되어있습니다. 1과 0이 교차하는 경우는 없습니다.

**표기법**

- IP주소처럼 8비트로 나누고 각각 자연수로 나누어 보여줍니다.
- 혹은, / 뒤에 연속한 1의 갯수로 표기합니다.

ex) 192.168.1.1 255.255.255.0 혹은 192.168.1.1/24

### 정해진 주소

- 호스트부를 모두 0으로 채우면 네트워크 자체를 식별하기 위한 “네트워크 주소"가 됩니다.
- 호스트부를 모두 1로 채우면 “브로드캐스트 주소"가 됩니다.
